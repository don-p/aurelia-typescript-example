<template>
<require from="../lib/loading-mask/loading-mask"></require>

    <ul class="nav nav-tabs nav-append-content">
        <li class.bind="requestType == 'PENDING'?'active':''">
            <a id="tabReceivedRequests"  click.delegate="showRequests('PENDING')">Received requests</a>
        </li>
        <li class.bind="requestType == 'INVITED'?'active':''">
            <a id="tabSentRequests"  click.delegate="showRequests('INVITED')">Sent requests</a>
        </li>
        <li>requestType:${requestType}</li>

    </ul>
    <div id="requests-tab" class="blg-tab-section tab-content ">
        <div class="blg-inner-content tab-pane active" id="requests">
            <div show.bind="requestType == 'PENDING'" class="blg-connection-content">
                <div style="height: 100%;" class="members-table-content" id="membersTableContent">	
                    <ag-grid-aurelia id="receivedRequestsGrid" #agGrid style="bottom: 215px;top: 39px;position: absolute;width: 100%; " class="ag-blg"
                                    grid-options.bind="gridOptionsReceived"
                                    context.bind="$this"
                                    enable-col-resize
                                    enable-sorting
                                    enable-filter="false"
                                    row-clicked.call="onReceivedRequestSelected($event)"
                                    debug>
                        <ag-grid-column header-name="${'community.communities.members.firstname' | t}" field="physicalPersonProfile.firstName"></ag-grid-column>
                        <ag-grid-column header-name="${'community.communities.members.lastname' | t}" field="physicalPersonProfile.lastName" ></ag-grid-column>
                        <ag-grid-column header-name="${'community.communities.members.organization' | t}" field="physicalPersonProfile.organization.organizationName" ></ag-grid-column>
                    </ag-grid-aurelia>  
                    <div show.bind="!!(selectedRequest)" style="position: absolute;height: 200px; border: 1px solid; bottom: 15px; width: 100%;">
                        <div >
                            <div>From:</div><div>${selectedRequest.physicalPersonProfile.firstName} ${selectedRequest.physicalPersonProfile.lastName} </div>
                            <div>Organization:</div><div>${selectedRequest.physicalPersonProfile.organization.organizationName}</div>
                            <div>Date:</div><div></div>
                            <div>Message:</div><div>${selectedRequest.statusComment}</div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" click.trigger="editConnectionRequest([selectedRequest], 'DECLINE', 'REQUEST_DECLINED')">Decline</button>
                            <button  type="submit" class="btn btn-primary" click.trigger="editConnectionRequest([selectedRequest], 'ACCEPT', 'REQUEST_ACCEPTED')">Accept</button>
                        </div>
                    </div>     
                </div>
            </div>
            <div show.bind="requestType == 'INVITED'" class="blg-connection-content">
                <div style="height: 100%;" class="members-table-content" id="membersTableContent">	
                   <ag-grid-aurelia id="sentRequestsGrid" #agGrid style="width: 100%;" class="ag-blg"
                                    grid-options.bind="gridOptionsSent"
                                    column-defs.bind="gridOptionsSent.columnDefs"
                                    context.bind="$this"
                                    enable-col-resize
                                    enable-sorting
                                    enable-filter="false"
                                    suppress-row-click-selection
                                    debug>
                        <ag-grid-column header-name="${'community.communities.members.firstname' | t}" field="physicalPersonProfile.firstName"></ag-grid-column>
                        <ag-grid-column header-name="${'community.communities.members.lastname' | t}" field="physicalPersonProfile.lastName" ></ag-grid-column>
                        <ag-grid-column header-name="${'community.communities.members.organization' | t}" field="physicalPersonProfile.organization.organizationName" ></ag-grid-column>
                        <ag-grid-column header-name="" >
                            <ag-cell-template>
                                <i click.delegate="params.context.editConnectionRequest([params.data], 'TERMINATE', 'REQUEST_TERMINATED')" class="ico-bin float-right"></i>
                            </ag-cell-template>
                        </ag-grid-column>
                    </ag-grid-aurelia>       
                </div>
            </div>
        </div>					
    </div>

</template>